# Creating a new React Component for v3's website

## Create the component

- Each component should be in its own directory
- Should be placed in `/app/javascript/components/<componentname>`

## Create the tests

- Place tests in `/test/javascript/components/<component-name>/ComponentName.test.tsx`
- The tests must use the [JEST](https://jestjs.io/) test framework
- [Testing Library](https://testing-library.com/) is useful for testing your react component
- [Pluralsight has a crashcourse](https://www.pluralsight.com/guides/how-to-test-react-components-in-typescript) in testing React component
- See [common workflows](./common_workflows.md) to see how to run the jest tests

## Add it to the application

- Open `/app/javascript/packs/application.tsx`
- The `initReact` function takes an object where each entry represents a react component
    - The key is a string representing your component
    - The value is a function
        - Arguments
            - `data`, represents the data required by your component to be initialized
        - Return
            - Your react component, with the `data` assigned to it
    - assume the data has already been massaged to a desired format

## Add the a test route

- Open `/config/routes.rb`
- In `namespace :test` > `namespace :components` add your component to the proper section adding a `:show` resource

`resource  :component_name, only: \[:show\], controller:  'component_name'`

## Create the test controller

- Create a file `/app/controllers/test/components/component_name_controller.rb`
- Create a class that inherits from the `ApplicationController`
- This allows you to navigate in the browser to: `http://localhost:3020/test/components/component_name` to view the component rendered

```ruby
class  Test::Components::ComponentName < ApplicationController  \# rubocop:disable Layout/LineLength
    def show
        @data = {
            # Whatever mocked data should be passed to your component to view it
        }
    end
end
```

## Create the view

React components at this time are used to supplement other views, and likely do not have a view for you to create at this time

## Create the view helper test

- Create a file `/test/helpers/view_components/component_name_test.rb`
- This tests that the output from the Route renders matching HTML generated by `application.tsx`

```ruby
require_relative "../view_component_test_case"

class ComponentNameTest < ViewComponentTestCase
    test "component with empty concepts map rendered correctly" do
      data = {
          # Whatever data you want to test
      }
      component = ViewComponents::ComponentName.new(data).to_s

      assert_component component, "concepts-map", data
    end
end
```

## Create the system test (for Capybara)

- Create a file `/test/system/component/component_name_test.rb`

```ruby
require "application_system_test_case"

module Components
    class ComponentNameTest < ApplicationSystemTestCase
        def setup
            super
            # This component uses the API, which requires authentication.
            sign_in!
        end

        # Add in your cabybara test cases here
        # See https://teamcapybara.github.io/capybara/
        # and https://rubydoc.info/github/teamcapybara/capybara/master
    end
end
```
